# Руководство по тестированию программы

## Быстрый запуск

### 1. Сборка программы (если нужно пересобрать)

```bash
cd build
cmake ..
make
```

### 2. Запуск программы

```bash
./build/src/lab07
```

Программа автоматически:
- Создаст 50 NPC в случайных позициях
- Запустит 3 потока (передвижение, бои, вывод)
- Будет работать 30 секунд
- Выведет карту каждую секунду
- После окончания покажет список выживших

## Что проверять при тестировании

### ✅ Базовые проверки

1. **Запуск программы**
   - Программа должна запуститься без ошибок
   - Должно появиться сообщение о создании 50 NPC

2. **Вывод карты**
   - Карта должна выводиться каждую секунду
   - На карте должны отображаться только живые NPC
   - Мертвые NPC не должны появляться на карте

3. **Передвижение NPC**
   - NPC должны перемещаться по карте
   - NPC не должны выходить за границы карты (0-100)
   - Мертвые NPC не должны двигаться

4. **Бои**
   - Когда два NPC находятся на расстоянии убийства, должен происходить бой
   - Результат боя определяется кубиком (1-6)
   - После боя один из NPC может умереть

5. **Завершение игры**
   - Через 30 секунд игра должна остановиться
   - Должен вывестись список выживших с их координатами

### ✅ Проверка многопоточности

1. **Синхронизация вывода**
   - Вывод карты не должен "смешиваться" с другими сообщениями
   - Все сообщения должны быть целостными

2. **Отсутствие гонок данных (race conditions)**
   - Программа не должна падать
   - Не должно быть некорректных данных (например, отрицательные координаты)

### ✅ Проверка логики боев

1. **Таблица убиваемости**
   - Проверьте, что NPC могут убивать только тех, кого должны по таблице
   - Например, Орк должен убивать Белку, Друида, Эльфа и т.д.

2. **Расстояния**
   - NPC должны двигаться на правильное расстояние (согласно типу)
   - Бои должны происходить только на расстоянии убийства

3. **Кубик**
   - Сила атаки и защиты должны быть от 1 до 6
   - Убийство происходит только если атака > защиты

## Тестовые сценарии

### Сценарий 1: Базовая проверка
```bash
./build/src/lab07
```
**Ожидаемый результат:**
- Программа работает 30 секунд
- Карта выводится каждую секунду
- В конце выводится список выживших

### Сценарий 2: Проверка границ карты
Наблюдайте за NPC на краях карты (координаты близкие к 0 или 100).
**Ожидаемый результат:**
- NPC не выходят за границы
- При достижении границы NPC отражаются обратно

### Сценарий 3: Проверка боев
Наблюдайте за NPC, которые сближаются.
**Ожидаемый результат:**
- Когда два NPC находятся на расстоянии убийства, происходит бой
- Один из NPC может умереть
- Мертвые NPC исчезают с карты

### Сценарий 4: Проверка многопоточности
Запустите программу несколько раз подряд.
**Ожидаемый результат:**
- Программа работает стабильно
- Нет падений или зависаний
- Вывод синхронизирован

## Отладка

### Если программа не запускается

1. **Проверьте сборку:**
   ```bash
   cd build
   make clean
   cmake ..
   make
   ```

2. **Проверьте зависимости:**
   - Убедитесь, что используется C++17 или выше
   - Проверьте версию CMake (должна быть 3.14+)

### Если программа падает

1. **Проверьте логи:**
   - Запустите с отладкой: `gdb ./build/src/lab07`
   - Или с valgrind: `valgrind ./build/src/lab07`

2. **Проверьте синхронизацию:**
   - Убедитесь, что все мьютексы используются правильно
   - Проверьте, что нет гонок данных

## Пример вывода

```
=== LAB-07: Asynchronous Programming ===
Creating 50 NPCs in random locations...
Starting game for 30 seconds...

=== DUNGEON MAP ===
Size: 100x100
Alive NPCs: 48

. . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . .
...

=== GAME OVER ===
Survivors:
Total survivors: 12

        ORC ORC_5 at (45.23, 67.89)
     DRAGON DRAGON_12 at (12.34, 56.78)
     ...
```

## Дополнительные тесты

### Тест производительности
Запустите программу и проверьте:
- Нет ли утечек памяти
- Нет ли излишней нагрузки на CPU
- Работают ли все потоки параллельно

### Тест стабильности
Запустите программу несколько раз:
- Результаты должны быть разными (случайность)
- Программа не должна падать
- Все потоки должны корректно завершаться

